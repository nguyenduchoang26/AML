
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ICAT3190, Module 5, Excercises &#8212; Applied Machine Learning, 2021</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/ApplesAndOranges.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applied Machine Learning, 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../practicalities.html">
   About the course
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ReadingAndPlotting.html">
   2. Reading and plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Preprocessing_and_feature_extraction.html">
   3. Preprocessing and feature extraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Subspace_Projections.html">
   4. Dimensionality reduction by Subspace projections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Clustering.html">
   5. Unsupervised learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../SupervisedMachineLearningTerminology.html">
   6. Supervised machine learning, Terminology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NearestNeighbors.html">
   7. Nearest Neighbours methods
   <a class="anchor" id="nearestneighbours">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../SupportVectorMachine.html">
   8. Support Vector Machine (SVM)
   <a class="anchor" id="supportvectormachine">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DecisionTrees.html">
   9. Decision trees and forests
   <a class="anchor" id="dtaforests">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Regression.html">
   10. Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NeuralNetworks.html">
   11. Artificial Neural Networks (ANN)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/excercises/Excercise_5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pevalisuo/AML.git/master?urlpath=tree/book/excercises/Excercise_5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://notebooks.csc.fi/#/blueprint/d1fe6e08032e4c17a0f9e0e222414598/hub/user-redirect/git-pull?repo=https://github.com/pevalisuo/AML.git&urlpath=tree/AML.git/book/excercises/Excercise_5.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#satellite-image-classification">
   Satellite image classification
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training-data">
   Training data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-1">
   Task 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-data">
     Read the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-training-set-and-test-set">
     Make training set and test set
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-2">
   Task 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-3-select-the-best-channels">
   Task 3, Select the best channels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-4-extra-task">
   Task 4, Extra task
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="icat3190-module-5-excercises">
<h1>ICAT3190, Module 5, Excercises<a class="headerlink" href="#icat3190-module-5-excercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="satellite-image-classification">
<h2>Satellite image classification<a class="headerlink" href="#satellite-image-classification" title="Permalink to this headline">¶</a></h2>
<p>Following satellite image is obtained from the Söderfjärden meteorite crater near Vaasa at 10:00 in 28.9.2019. The image is acquired from European Sentinell 2 satellite by means of multispectral imaging device (MSI). The multispectral camera has acquired the image using 13 different wavelength bands instead of three (RGB) in the normal camera. The image was searched and dowloaded using <a class="reference external" href="https://scihub.copernicus.eu/dhus/">Copernicus Open Access Hub</a>, and preprosessed by using ESA’s <a class="reference external" href="http://step.esa.int/main/download/">SNAP</a> tool.</p>
<p>The bands used are</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Band number</p></th>
<th class="head"><p>Band name</p></th>
<th class="head"><p>Wavelength</p></th>
<th class="head"><p>Region</p></th>
<th class="head"><p>Remarks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>B1</p></td>
<td><p>443 nm</p></td>
<td><p>Violet</p></td>
<td><p>Chlorophyll-A</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>B2</p></td>
<td><p>490 nm</p></td>
<td><p>Cyan</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>B3</p></td>
<td><p>560 nm</p></td>
<td><p>Green</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>B4</p></td>
<td><p>665 nm</p></td>
<td><p>Red</p></td>
<td><p>Chlorophyll_A</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>B5</p></td>
<td><p>705 nm</p></td>
<td><p>Red</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>B6</p></td>
<td><p>740 nm</p></td>
<td><p>Red</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>B7</p></td>
<td><p>783 nm</p></td>
<td><p>Deep red</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>B8</p></td>
<td><p>842 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>B8A</p></td>
<td><p>865 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>B9</p></td>
<td><p>945 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>B10</p></td>
<td><p>1375 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>B11</p></td>
<td><p>1610 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>B12</p></td>
<td><p>2190 nm</p></td>
<td><p>NIR</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>The channels listed above can be used for creating a natural looking RGB-image, as shown below.</p>
<p><img alt="machine_learning.svg" src="excercises/kuvat/Soderfjarden_image.png" /></p>
<p>Even though, only three channels are used for RGB image, all 13 can be usefull features for land type and crops classification.</p>
</div>
<div class="section" id="training-data">
<h2>Training data<a class="headerlink" href="#training-data" title="Permalink to this headline">¶</a></h2>
<p>In the image above, an expert has manually segmented some areas of the image and labelled them according to land use. The labelled areas are:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Segment no.</p></th>
<th class="head"><p>Segment name</p></th>
<th class="head"><p>Segment color</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Water</p></td>
<td><p>Violet</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Forest</p></td>
<td><p>Green</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>HayField</p></td>
<td><p>Red</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>StrawField</p></td>
<td><p>Light Green</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>DarkSoil</p></td>
<td><p>Blue</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="task-1">
<h2>Task 1<a class="headerlink" href="#task-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="read-the-data">
<h3>Read the data<a class="headerlink" href="#read-the-data" title="Permalink to this headline">¶</a></h3>
<p>Open the training data, which contains the pixel values of the segmented regions shown in the image above. Each pixel contains 13 floating point values between 0 and 1, one for each channel.</p>
<p>The training data is stored in a HDF5 file <code class="docutils literal notranslate"><span class="pre">Soderfjarden_training_data.h5</span></code>, it has following data sets:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spectra</span></code>: a matrix, which dimensions are (23754, 15). Notice that two first values are the x and y coordinates of the pixel. Do not use them for classification, but use only following 13 channels. Construct a design matrix X (23754,13) by slicing this data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">labels</span></code>: The expert segmented labels (23754, 1), the true values, the ground truth. This is the y-vector which you try to predict</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">colnames</span></code>: The name of the columns (15,1), if you need them. Contains the band names, shown in he table above, plus the name of the x and y coordinate columns.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavelengths</span></code>: The wavelengts of each band (13,1), the same shown in the table above.</p></li>
<li><p>The HDF5 includes also a data attribute called <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>, which contains the time when the image was acquired.</p></li>
</ul>
<p>If you can’t remember how to read HDF5 file, refer to excercise 3.</p>
</div>
<div class="section" id="make-training-set-and-test-set">
<h3>Make training set and test set<a class="headerlink" href="#make-training-set-and-test-set" title="Permalink to this headline">¶</a></h3>
<p>Separate your data X and y to training set (X_train, y_train) which contains 75% of the data and to the test set X_test, y_test which contains 25% of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##&gt;&gt;&gt; Some code for bootstrap</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_20732</span><span class="o">/</span><span class="mf">1805442443.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">h5py</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;h5py&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## &gt;&gt; Some tests, do not change</span>
<span class="k">assert</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">23754</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
<span class="k">assert</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">23754</span><span class="p">,))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-1-dae54fb501a2&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">## &gt;&gt; Some tests, do not change</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="k">assert</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">23754</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">assert</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">23754</span><span class="p">,))</span>

<span class="ne">NameError</span>: name &#39;X&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="task-2">
<h2>Task 2<a class="headerlink" href="#task-2" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Study the data, select a classifier, and train it using the training data.</p></li>
<li><p>Use cross validatin to test the performance of the classifier and tune it’s parameters as good as you can</p></li>
<li><p>Finally test the classifier with the test set</p></li>
<li><p>Report the classification accuracy in the training set, cross validation score and accuracy in the test set</p></li>
<li><p>Plot also the confusion matrix when predicting the test set.</p></li>
<li><p>What is your opinion of the performance? Is there signs of overfitting?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### &gt;&gt;&gt;&gt;&gt; Write your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### &gt;&gt;&gt;&gt; Some testing</span>
<span class="c1"># Your classifier should reach above 90% of accuracy in the test set</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="task-3-select-the-best-channels">
<h2>Task 3, Select the best channels<a class="headerlink" href="#task-3-select-the-best-channels" title="Permalink to this headline">¶</a></h2>
<p>Like it often is, some features are more important for classification than the others.</p>
<ul class="simple">
<li><p>Study which channels are the most important for the classification. You can use LASSO or Elastic Nets to select variables (SelectFromModel), as shown in the lecture notes of Module 6, or ir you use random forests (Extratrees, or boosted trees), they already keep account on most often used features, see also lecture notes of Module 6.</p></li>
<li><p>Plot of scatter plot of pixels in the training set, using two most important features</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &gt;&gt; Write your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### &gt;&gt;&gt; Some testing</span>
<span class="c1"># It seems that there are only a few bands which are sufficient for classification. </span>
<span class="c1"># Threfore you should get pretty nice separation of clusters in the scatter plot</span>
<span class="c1"># You can also try to plot a scatter plot with PCA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="task-4-extra-task">
<h2>Task 4, Extra task<a class="headerlink" href="#task-4-extra-task" title="Permalink to this headline">¶</a></h2>
<p>Now you have trained a classifier to perform well in the trainig data. It is time to put it in actual work.</p>
<ul class="simple">
<li><p>Read the data of the whole image from another HDF5 file <code class="docutils literal notranslate"><span class="pre">Soderfjarden_image.h5</span></code>. It has the same structure as the training data file, except few differences</p>
<ul>
<li><p>There is no labels available, since the whole image is not labeled</p></li>
<li><p>There is no pixel coordinates in the begining of spectra matrix, but only n samples and 13 channels</p></li>
<li><p>There are also two additional attributes (width=924, height=630) which shows the image dimensions</p></li>
</ul>
</li>
<li><p>Predict all values in the image, and store the results in vector y</p></li>
<li><p>Convert y to numerical, so that each class is described by a unique integer</p></li>
<li><p>Reshape y to image shape <code class="docutils literal notranslate"><span class="pre">image=y.reshape(630,924)</span></code></p></li>
<li><p>Plot the image <code class="docutils literal notranslate"><span class="pre">plt.imshow(img)</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###&gt;&gt;&gt; Write your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##&gt;&gt;&gt; SOme testing</span>
<span class="c1"># You should see that all pixels are now assigned to some classes. You can compare with the original</span>
<span class="c1"># image and try to find out if the classification looks good.</span>
<span class="c1"># If it does not, how it could be improved?</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./excercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Petri Välisuo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>